<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Change note generator</title>
  </head>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 0;
      font-family: Arial, sans-serif;
      flex-direction: column;
    }

    .spinner {
      border: 4px solid rgba(0, 0, 0, 0.1); /* Light gray */
      border-left-color: rgb(255, 255, 255); /* Black spinner */
      border-radius: 50%;
      width: 16px;
      height: 16px;
      display: inline-block;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }

    #parent {
      display: flex;
      gap: 10px;
      max-width: 90vw;
    }

    textarea {
      width: 700px;
      height: 500px;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1);
    }

    button {
      margin-top: 10px;
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 4px;
      background-color: #007bff;
      color: white;
      cursor: pointer;
    }

    button:hover {
      background-color: #0056b3;
    }

    #result {
      margin: 0 auto;
      font-size: 18px;
    }

    h1 {
      margin-bottom: 20px;
    }

    p {
      max-width: 1000px;
      padding: 0 15px 0 15px;
    }
  </style>
  <body>
    <h1>Change Note Generator</h1>
    <p>
      Paste two version of your markdown content in the boxes below, and click
      "Get change notes" to automatically generate change notes based on the two
      versions.
    </p>
    <div id="parent">
      <textarea id="current-content" placeholder="Current content"></textarea>
      <textarea id="updated-content" placeholder="Updated content"></textarea>
    </div>
    <button id="generate-btn"  onclick="generateChangeNotes()">
      <span id="spinner" class="spinner" ></span>
    </button>
      <div>
        <span>Get change notes</span>
      </div>
    </button>
    <div id="result-wrapper">
      <p id="accuracy">Changes notes look good</p>
      <p id="change-summary">
        Here are the differences between the CURRENT CONTENT and the NEW
        CONTENT, categorized as CHANGE, REMOVAL, or DIFFERENCE: - **CHANGE**:
        The section title has changed from "How to work out what funding you'll
        get" to "If you changed course, stopped your studies or are repeating a
        year." - **CHANGE**: The text explaining the calculation of funding has
        been revised to clarify what types of loans are applicable. In the NEW
        CONTENT, it states, "If you're eligible for Maintenance Loans or Grants,
        you should get them for every year of your new course," and "Any Tuition
        Fee Loans you’re eligible for will be applied to the final years of your
        new course." This adds specificity about the types of funding. -
        **REMOVAL**: The specific calculation example for funding based on the
        length of study has been modified. The example in the CURRENT CONTENT
        states, “If you are applying for a 3 year course and have studied 5
        months of a different course, you’ll get 3 years of funding," while in
        the NEW CONTENT, it has been changed to "If you’re applying for a 3 year
        course and have studied 2 years of a different course, you’ll get a
        Maintenance Loan in year 1 and Tuition Fees and Maintenance Loans in
        years 2 and 3."
      </p>
      <p id="result">
        CHANGE NOTES [1] LOCATION: ###If you changed course, stopped your
        studies or are repeating a year CHANGE You can calculate the amount you
        will get by taking the total number of years of the course you are
        applying for and adding one year. Then take away the number of years you
        studied for. If you studied for part of a year you should count it as a
        whole year. TO You can calculate how many years you’ll get them for by
        taking the total number of years you’re applying for and adding one
        year. Then, take away the number of years you studied for previously. If
        you studied for part of a year, you should count it as a whole year.
        SUMMARY Revised the wording for clarity and consistency regarding the
        calculation of funding years. [2] LOCATION: ####How to work out what
        funding you'll get CHANGE $E TO If you're eligible for Maintenance Loans
        or Grants, you should get them for every year of your new course. Any
        Tuition Fee Loans you’re eligible for will be applied to the final years
        of your new course. SUMMARY This section is new in the NEW CONTENT,
        providing clarity on Maintenance Loans and Tuition Fee Loans. [3]
        LOCATION: ###Example CHANGE If you are applying for a 3 year course and
        have studied 5 months of a different course, you’ll get 3 years of
        funding. If you are applying for a 4 year course and have studied 2
        years of a different course, you’ll get 3 years of funding. TO If you’re
        applying for a 3 year course and have studied 2 years of a different
        course, you’ll get a Maintenance Loan in year 1 and Tuition Fees and
        Maintenance Loans in years 2 and 3. If you’ve already completed a 3 year
        course but didn’t gain a qualification and want to apply for another 3
        year course, you’ll get Maintenance Loans in years 1 and 2. You’ll get
        Tuition Fees and Maintenance Loans in year 3. SUMMARY Revised examples
        to provide specific details about the types of loans received and
        altered the scenarios presented. Adjusted the numbers and descriptions
        for clarity. [4] LOCATION: ###Example CHANGE $E TO $E SUMMARY The
        placement of the dollar sign ($E) was retained but its surrounding
        context has changed due to the revised content.
      </p>
    </div>

    <script>
      async function generateChangeNotes() {

        // Get references to the button and spinner
        const button = document.getElementById("generate-btn");
        const spinner = document.getElementById("spinner");

        // Show the spinner
        spinner.style.display = "inline-block";
        button.disabled = true; // Disable the button while processing

        const currentContent = document.getElementById("current-content").value;
        const updatedContent = document.getElementById("updated-content").value;

        const response = await fetch("/generate", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            currentContent,
            updatedContent,
          }),
        });

        const data = await response.json();
        console.log(data);
        document.getElementById("result").innerText = data.changeNotes;
        document.getElementById("accuracy").innerText = data.accuracyCheck;
        document.getElementById("change-summary").innerText =
          data.descriptionOfChanges;
      }
      // Hide the spinner and re-enable the button after the request is complete
      spinner.style.display = "none";
      button.disabled = false;
    </script>
  </body>
</html>
